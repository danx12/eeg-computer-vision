#!/usr/bin/env python2
# -*- coding: utf-8 -*-
"""
Created on Sun Nov 27 21:38:38 2016

@author: danielvillarreal
"""

import numpy as np
import scipy as sp
from scipy import signal

coeffs1 = np.array([
                  0.0002691785812745,0.0001497766403693, -0.00135054384779,-0.004139628118676,
  -0.005783744106613,-0.003615371535455, 0.001240487444773, 0.003696560428483,
  0.0006696873522113,-0.003852391317585,-0.003081183601772, 0.002804507735446,
   0.005434397981279,-0.0001856408257089,-0.006790252704335,-0.003816258571349,
   0.006084638858974, 0.008283811553756,-0.002600086161222,  -0.0116946149565,
  -0.003633856661478,  0.01226179867808,  0.01159640442095,-0.008418795853536,
   -0.01925943796094,-0.0006696804300454,  0.02381118436631,  0.01473484327969,
   -0.02197459490524, -0.03226012466387,  0.01012773067417,  0.05071507197981,
    0.01699415630704, -0.06700655774915,  -0.0749818556971,  0.07819377884688,
     0.3073788855435,   0.4178226576249,   0.3073788855435,  0.07819377884688,
    -0.0749818556971, -0.06700655774915,  0.01699415630704,  0.05071507197981,
    0.01012773067417, -0.03226012466387, -0.02197459490524,  0.01473484327969,
    0.02381118436631,-0.0006696804300454, -0.01925943796094,-0.008418795853536,
    0.01159640442095,  0.01226179867808,-0.003633856661478,  -0.0116946149565,
  -0.002600086161222, 0.008283811553756, 0.006084638858974,-0.003816258571349,
  -0.006790252704335,-0.0001856408257089, 0.005434397981279, 0.002804507735446,
  -0.003081183601772,-0.003852391317585,0.0006696873522113, 0.003696560428483,
   0.001240487444773,-0.003615371535455,-0.005783744106613,-0.004139628118676,
   -0.00135054384779,0.0001497766403693,0.0002691785812745],dtype='float64')


coeffs2 = np.array([
      0.0003194879408334,   0.0014884935669, 0.002756297394609, 0.002527987761899,
  5.362695365564e-05, -0.00243770798774, -0.00170860212805, 0.001892311230087,
   0.003520459948692,-4.511889945953e-05,-0.004654721809233,-0.003123293581869,
   0.003955620050576, 0.006712327972941,  -0.0006428799523,-0.009063869803266,
  -0.005120029444439, 0.008255315539391,  0.01188710132296,-0.002861932087191,
   -0.01701929928469,-0.007269030381619,  0.01719508771868,  0.02043974870977,
  -0.009261476787136, -0.03300042305167,-0.009096370513322,  0.03946519748719,
    0.03958028959013, -0.03176612092443,   -0.087247487232, -0.01015124471945,
     0.1976409649711,   0.3823069979099,   0.3823069979099,   0.1976409649711,
   -0.01015124471945,   -0.087247487232, -0.03176612092443,  0.03958028959013,
    0.03946519748719,-0.009096370513322, -0.03300042305167,-0.009261476787136,
    0.02043974870977,  0.01719508771868,-0.007269030381619, -0.01701929928469,
  -0.002861932087191,  0.01188710132296, 0.008255315539391,-0.005120029444439,
  -0.009063869803266,  -0.0006428799523, 0.006712327972941, 0.003955620050576,
  -0.003123293581869,-0.004654721809233,-4.511889945953e-05, 0.003520459948692,
   0.001892311230087, -0.00170860212805, -0.00243770798774,5.362695365564e-05,
   0.002527987761899, 0.002756297394609,   0.0014884935669,0.0003194879408334],dtype='float64')

def lowpassFilter(data,selectCoeffs=1):
    dims = data.shape
    result = np.zeros(data.shape)
    if(selectCoeffs == 1):
        scoeffs = coeffs1
    elif(selectCoeffs == 2):
        scoeffs = coeffs2
    
    for c in range(0,dims[2]):
        result[:,:,c] = signal.convolve(np.ravel(data[:,:,c]),scoeffs,mode='same').reshape([dims[0],dims[1]])
    return np.reshape(result,dims)
    